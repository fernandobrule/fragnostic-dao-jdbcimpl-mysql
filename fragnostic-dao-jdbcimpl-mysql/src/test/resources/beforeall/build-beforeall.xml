
<project name="fragnostic dao jdbcimpl mysql" default="usage" basedir=".">

  <description>fragnostic dao jdbcimpl mysql</description>

  <property environment="env" />
  <property file="build-beforeall.properties"/>

  <target name="usage">
    <echo>===============================</echo>
    <echo>   Availables targets are:</echo>
    <echo>-------------------------------</echo>
    <echo>$ create-db --> create database '${db.name}'</echo>
    <echo>$ create-user --> create user</echo>
    <echo>$ cct --> cat create table</echo>
    <echo>$ cpt --> cat populate table</echo>
    <echo>$ ct ---> create table</echo>
    <echo>$ pt ---> populate table</echo>
    <echo>$ all ----> all targets</echo>
    <echo>===============================</echo>
  </target>


   <!-- 
   - CREATE DB
   -->
  <target name="create-db">
    <tstamp>
      <format property="archive.name" pattern="'${lod.dir}/frg-create-db.log'" />
    </tstamp>
    <echo>- db.root.url : ${db.root.url}</echo>
    <echo>- db.root.usr : ${db.root.usr}</echo>
    <echo>- db.root.psw : ${db.root.psw}</echo>
    <sql driver="${driver.class}" 
         url="${db.root.url}" 
         userid="${db.root.usr}" 
         password="${db.root.psw}" 
         src="scripts/create-db.sql" 
         print="yes" 
         output="${archive.name}">
      <classpath>
        <pathelement location="${driver.location}"/>
      </classpath>
    </sql>
    <echo>-------------------------------------</echo>
    <echo>SUCCESS: create db done</echo>
    <echo>-------------------------------------</echo>
  </target>


   <!-- 
   - CREATE USER
   -->
  <target name="create-user">
    <tstamp>
      <format property="archive.name" pattern="'${lod.dir}/frg-create-user.log'" />
    </tstamp>
    <sql driver="${driver.class}" 
         url="${db.root.url}" 
         userid="${db.root.usr}" 
         password="${db.root.psw}" 
         src="scripts/create-db-user.sql" 
         print="yes" 
         output="${archive.name}">
      <classpath>
        <pathelement location="${driver.location}"/>
      </classpath>
    </sql>
    <echo>-------------------------------------</echo>
    <echo>SUCCESS: create usr done</echo>
    <echo>-------------------------------------</echo>
  </target>


   <!-- 
   - CREATE TEST TABLE
   -->
  <target name="create-table">
    <tstamp>
      <format property="archive.name" pattern="'${lod.dir}/frg-create-table.log'" />
    </tstamp>
    <echo>- db.frg.url : ${db.frg.url}</echo>
    <echo>- db.frg.usr : ${db.frg.usr}</echo>
    <echo>- db.frg.psw : ${db.frg.psw}</echo>
    <sql driver="${driver.class}" 
         url="${db.frg.url}" 
         userid="${db.frg.usr}" 
         password="${db.frg.psw}" 
         src="scripts/create-table.sql" 
         print="yes" 
         output="${archive.name}">
      <classpath>
        <pathelement location="${driver.location}"/>
      </classpath>
    </sql>
    <echo>-------------------------------------</echo>
    <echo>SUCCESS: create db done</echo>
    <echo>-------------------------------------</echo>
  </target>


   <!-- 
   - BEFORE ALL
   -->
  <target name="beforeall" depends="create-db, create-user, create-table">
    <echo>Before All Done</echo>
  </target>

</project>
